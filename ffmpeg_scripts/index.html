
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../configuration/">
      
      
        <link rel="next" href="../additional_scripts/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.17">
    
    
      
        <title>FFmpeg scripts - ffmpeg_python_utils</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.26e3688c.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ffmpeg-scripts" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ffmpeg_python_utils" class="md-header__button md-logo" aria-label="ffmpeg_python_utils" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ffmpeg_python_utils
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              FFmpeg scripts
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ffmpeg_python_utils" class="md-nav__button md-logo" aria-label="ffmpeg_python_utils" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    ffmpeg_python_utils
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Main
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          FFmpeg scripts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        FFmpeg scripts
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#process" class="md-nav__link">
    Process
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#function" class="md-nav__link">
    Function
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#arguments" class="md-nav__link">
    Arguments
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code" class="md-nav__link">
    Code
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main" class="md-nav__link">
    ffmpeg_python_utils.main
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.add_audio_to_video" class="md-nav__link">
    add_audio_to_video()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.add_blurred_space_around_video" class="md-nav__link">
    add_blurred_space_around_video()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.add_colored_space_around_video" class="md-nav__link">
    add_colored_space_around_video()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.add_image_to_video" class="md-nav__link">
    add_image_to_video()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.add_rectangle_to_video" class="md-nav__link">
    add_rectangle_to_video()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.add_text_to_video" class="md-nav__link">
    add_text_to_video()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.add_video_to_video" class="md-nav__link">
    add_video_to_video()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_audio_from_video" class="md-nav__link">
    get_audio_from_video()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_audio_info" class="md-nav__link">
    get_audio_info()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_concantenated_videos" class="md-nav__link">
    get_concantenated_videos()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_cropped_video" class="md-nav__link">
    get_cropped_video()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_frame" class="md-nav__link">
    get_frame()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_image_info" class="md-nav__link">
    get_image_info()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_mirrored_video" class="md-nav__link">
    get_mirrored_video()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_resized_image" class="md-nav__link">
    get_resized_image()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_resized_video" class="md-nav__link">
    get_resized_video()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_rotated_video" class="md-nav__link">
    get_rotated_video()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_subclips_with_sound" class="md-nav__link">
    get_subclips_with_sound()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_video_from_picture" class="md-nav__link">
    get_video_from_picture()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_video_info" class="md-nav__link">
    get_video_info()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../additional_scripts/" class="md-nav__link">
        Additional scripts
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#process" class="md-nav__link">
    Process
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#function" class="md-nav__link">
    Function
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#arguments" class="md-nav__link">
    Arguments
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code" class="md-nav__link">
    Code
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main" class="md-nav__link">
    ffmpeg_python_utils.main
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.add_audio_to_video" class="md-nav__link">
    add_audio_to_video()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.add_blurred_space_around_video" class="md-nav__link">
    add_blurred_space_around_video()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.add_colored_space_around_video" class="md-nav__link">
    add_colored_space_around_video()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.add_image_to_video" class="md-nav__link">
    add_image_to_video()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.add_rectangle_to_video" class="md-nav__link">
    add_rectangle_to_video()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.add_text_to_video" class="md-nav__link">
    add_text_to_video()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.add_video_to_video" class="md-nav__link">
    add_video_to_video()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_audio_from_video" class="md-nav__link">
    get_audio_from_video()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_audio_info" class="md-nav__link">
    get_audio_info()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_concantenated_videos" class="md-nav__link">
    get_concantenated_videos()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_cropped_video" class="md-nav__link">
    get_cropped_video()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_frame" class="md-nav__link">
    get_frame()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_image_info" class="md-nav__link">
    get_image_info()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_mirrored_video" class="md-nav__link">
    get_mirrored_video()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_resized_image" class="md-nav__link">
    get_resized_image()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_resized_video" class="md-nav__link">
    get_resized_video()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_rotated_video" class="md-nav__link">
    get_rotated_video()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_subclips_with_sound" class="md-nav__link">
    get_subclips_with_sound()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_video_from_picture" class="md-nav__link">
    get_video_from_picture()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ffmpeg_python_utils.main.get_video_info" class="md-nav__link">
    get_video_info()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="ffmpeg-scripts">FFmpeg scripts</h1>
<h3 id="process">Process</h3>
<p>Each function is first processed by the <code>@process</code> decorator. </p>
<ul>
<li>
<p>It checks if the file at input_path can be accessed and read. </p>
</li>
<li>
<p>If needed according config, it can rename the input file and change the output to avoid using special symbols (although it may not be necessary since we can use quotes around file names). </p>
</li>
<li>
<p>Then it checks if we rewrite <code>input_path</code> since it is not possible to do directly with ffmpeg. If so, it renames the input path as 'fn_tmp' and deletes it after function execution.</p>
</li>
</ul>
<h3 id="function">Function</h3>
<ul>
<li>
<p>It makes the plural-form arguments equal in length (see below).</p>
</li>
<li>
<p>It constructs a command line to be run by subprocess.</p>
</li>
<li>
<p>If the length of the command line exceeds 8000, the filter part of the cmd string is saved to cmd_tmp.txt and run by -filter_complex_script.</p>
</li>
</ul>
<h3 id="arguments">Arguments</h3>
<ul>
<li>Arguments whose names end with 's' (plural form) should get a list. If you can pass a list, pass it. This was done on purpose to avoid rerendering a 2-hour video each time we make a minor change - we pass the full list of needed changes.</li>
<li>
<p>If the length of the plural-form arguments differs from each other, the function will make them equal in length by adding the last element to each of them.</p>
<p><code>font_colors = ['red']
  font_sizes = [500, 200]
  # Making them equal
  font_colors = ['red', 'red']
  font_sizes = [500, 200]</code></p>
</li>
<li>
<p>Path arguments should be passed as strings.</p>
</li>
<li>The argument <code>size</code> should contain <code>[width, height]</code>, and <code>sizes</code> should contain a list of them.</li>
<li>The argument <code>x_y_coordinate</code> should contain <code>[x_coordinate, y_coordinate]</code>, and <code>x_y_coordinates</code> should contain a list of them.</li>
<li><code>fonts</code> should be passed with full path like <code>['C\:\\\\Windows\\\\Fonts\\\\Arial.ttf']</code>, overwise ffmpeg raise error.</li>
<li><code>colors</code> should be passed as strings like 'FFFFFF' or as defaults colors like 'white'</li>
<li>You can pass ffmpeg things like "1920, -1', 'red', '(w-text_w)/2' to size, color, x_y_coordinate, respectively. Check <a href="https://ffmpeg.org/documentation.html">ffmpeg documentation</a></li>
<li></li>
</ul>
<h3 id="code">Code</h3>


<div class="doc doc-object doc-module">


<a id="ffmpeg_python_utils.main"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="ffmpeg_python_utils.main.add_audio_to_video" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_audio_to_video</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">input_audio_paths</span><span class="p">,</span> <span class="n">sound_volumes</span><span class="p">,</span> <span class="n">start_times</span><span class="p">,</span> <span class="n">durations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Adds audio tracks to a video using ffmpeg.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_video_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the input video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the output video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>input_audio_paths</code></td>
          <td>
                <code>list[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of paths to the input audio files.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>sound_volumes</code></td>
          <td>
                <code>list[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of sound volumes for each audio track.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>start_times</code></td>
          <td>
                <code>list[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of start times for each audio track in seconds.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>durations</code></td>
          <td>
                <code>list[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of durations for each audio track.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the output video file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>ffmpeg_python_utils\main.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@process</span>
<span class="k">def</span> <span class="nf">add_audio_to_video</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">input_audio_paths</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                       <span class="n">sound_volumes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">start_times</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">durations</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds audio tracks to a video using ffmpeg.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_video_path (str): The path to the input video file.</span>
<span class="sd">        output_path (str): The path to the output video file.</span>
<span class="sd">        input_audio_paths (list[str]): A list of paths to the input audio files.</span>
<span class="sd">        sound_volumes (list[float]): A list of sound volumes for each audio track.</span>
<span class="sd">        start_times (list[float]): A list of start times for each audio track in seconds.</span>
<span class="sd">        durations (list[float], optional): A list of durations for each audio track.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The path to the output video file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Make lists equal</span>
    <span class="n">input_audio_paths</span><span class="p">,</span> <span class="n">sound_volumes</span><span class="p">,</span> <span class="n">start_times</span><span class="p">,</span> <span class="n">durations</span> <span class="o">=</span> <span class="n">make_lists_equal</span><span class="p">(</span>
        <span class="n">input_audio_paths</span><span class="o">=</span><span class="n">input_audio_paths</span><span class="p">,</span> <span class="n">sound_volumes</span><span class="o">=</span><span class="n">sound_volumes</span><span class="p">,</span> <span class="n">start_times</span><span class="o">=</span><span class="n">start_times</span><span class="p">,</span> <span class="n">durations</span><span class="o">=</span><span class="n">durations</span><span class="p">)</span>

    <span class="c1"># Setting files and filter strings</span>
    <span class="n">filter_str_0</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">filter_str_1</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">files_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;-i &quot;</span><span class="si">{</span><span class="n">input_video_path</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_audio_paths</span><span class="p">)):</span>
        <span class="n">files_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39; -i &quot;</span><span class="si">{</span><span class="n">input_audio_paths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
        <span class="n">filter_str_0</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;[</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">:a]volume=</span><span class="si">{</span><span class="n">sound_volumes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">,adelay=</span><span class="si">{</span><span class="n">start_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000</span><span class="si">}</span><span class="s1">|</span><span class="si">{</span><span class="n">start_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">filter_str_0</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;, atrim=start=0:duration=</span><span class="si">{</span><span class="n">durations</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="n">durations</span> <span class="ow">and</span> <span class="n">durations</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
        <span class="n">filter_str_0</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;[a</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">];&#39;</span>
        <span class="n">filter_str_1</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;[a</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">]&#39;</span>
    <span class="n">filter_str_1</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;[0:a]amix=inputs=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">input_audio_paths</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">:duration=longest[audio_out]&#39;</span>

    <span class="c1"># Run command</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;ffmpeg </span><span class="si">{</span><span class="n">files_str</span><span class="si">}</span><span class="s1"> -movflags +faststart -filter_complex &quot;</span><span class="si">{</span><span class="n">filter_str_0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">filter_str_1</span><span class="si">}</span><span class="s1">&quot; &#39;</span> \
          <span class="sa">f</span><span class="s1">&#39;-map 0:v -map &quot;[audio_out]&quot; -c:v copy -y &quot;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
    <span class="n">run_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">filter_str_0</span> <span class="o">+</span> <span class="n">filter_str_1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">output_path</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="ffmpeg_python_utils.main.add_blurred_space_around_video" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_blurred_space_around_video</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">goal_size</span><span class="p">,</span> <span class="n">to_resize_video</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Adds blurred space around a video using ffmpeg.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_video_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the input video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the output video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>goal_size</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The desired size of the output video. Can be passed as built-in ffmpeg thing like ['iw/2', -1] or as [int, int]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>to_resize_video</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether or not to resize the input video to fit the output size.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>sigma</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The amount of blur to apply to the space around the video.</p>
            </div>
          </td>
          <td>
                <code>20</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the output video file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>ffmpeg_python_utils\main.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@process</span>
<span class="k">def</span> <span class="nf">add_blurred_space_around_video</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">goal_size</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
                                   <span class="n">to_resize_video</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">sigma</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds blurred space around a video using ffmpeg.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_video_path (str): The path to the input video file.</span>
<span class="sd">        output_path (str): The path to the output video file.</span>
<span class="sd">        goal_size (list): The desired size of the output video. Can be passed as built-in ffmpeg thing like [&#39;iw/2&#39;, -1] or as [int, int]</span>
<span class="sd">        to_resize_video (bool, optional): Whether or not to resize the input video to fit the output size.</span>
<span class="sd">        sigma (int, optional): The amount of blur to apply to the space around the video.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The path to the output video file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">codec_to_use</span> <span class="o">=</span> <span class="n">get_codec_meeting_constraints</span><span class="p">(</span><span class="n">goal_size</span><span class="p">)</span>
    <span class="n">scale_w</span> <span class="o">=</span> <span class="p">(</span><span class="n">goal_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">goal_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">goal_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">scale_h</span> <span class="o">=</span> <span class="p">(</span><span class="n">goal_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">goal_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">goal_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">scale_copy_w</span> <span class="o">=</span> <span class="p">(</span><span class="n">goal_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">goal_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">goal_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">scale_copy_h</span> <span class="o">=</span> <span class="p">(</span><span class="n">goal_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">goal_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">goal_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">resize_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;[original]scale=</span><span class="si">{</span><span class="n">scale_w</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">scale_h</span><span class="si">}</span><span class="s1">[original];&#39;</span> <span class="k">if</span> <span class="n">to_resize_video</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
    <span class="n">filter_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;[0:v]split[original][copy];</span><span class="si">{</span><span class="n">resize_str</span><span class="si">}</span><span class="s1">&#39;</span> \
                 <span class="sa">f</span><span class="s1">&#39;[copy]scale=</span><span class="si">{</span><span class="n">scale_copy_w</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">scale_copy_h</span><span class="si">}</span><span class="s1">,crop=</span><span class="si">{</span><span class="n">goal_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">goal_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">,gblur=sigma=</span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s1">[blurred];&#39;</span> \
                 <span class="sa">f</span><span class="s1">&#39;[blurred][original]overlay=(main_w-overlay_w)/2:(main_h-overlay_h)/2&#39;</span>
    <span class="n">command</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;ffmpeg -y -i &quot;</span><span class="si">{</span><span class="n">input_video_path</span><span class="si">}</span><span class="s1">&quot; -movflags +faststart -filter_complex &quot;</span><span class="si">{</span><span class="n">filter_str</span><span class="si">}</span><span class="s1">&quot; </span><span class="si">{</span><span class="n">C_CODEC_SETTINGS</span><span class="p">[</span><span class="n">codec_to_use</span><span class="p">]</span><span class="si">}</span><span class="s1"> &quot;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
    <span class="n">run_command</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">filter_str</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output_path</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="ffmpeg_python_utils.main.add_colored_space_around_video" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_colored_space_around_video</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">goal_size</span><span class="p">,</span> <span class="n">to_resize_video</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">x_y_coordinate</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;(ow-iw)/2&#39;</span><span class="p">,</span> <span class="s1">&#39;(oh-ih)/2&#39;</span><span class="p">))</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Adds colored space around a video using ffmpeg.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_video_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the input video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the output video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>goal_size</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The desired size [w,h] of the output video. Can be passed as built-in ffmpeg thing like ['iw/2', -1] or as [int, int]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>to_resize_video</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether or not to resize the input video to fit the output size.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>color</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The color of the space around the video. Can be passed as built-in ffmpeg color name (black, red etc.) or as hex string like 'FFFFFF'.</p>
            </div>
          </td>
          <td>
                <code>&#39;black&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>x_y_coordinate</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The x and y coordinates of the video within the output space. Can be passed as built-in ffmpeg thing like ['iw/2', -1] or as [int, int]</p>
            </div>
          </td>
          <td>
                <code>(&#39;(ow-iw)/2&#39;, &#39;(oh-ih)/2&#39;)</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the output video file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>ffmpeg_python_utils\main.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@process</span>
<span class="k">def</span> <span class="nf">add_colored_space_around_video</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">goal_size</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
                                   <span class="n">to_resize_video</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>
                                   <span class="n">x_y_coordinate</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(ow-iw)/2&#39;</span><span class="p">,</span> <span class="s1">&#39;(oh-ih)/2&#39;</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds colored space around a video using ffmpeg.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_video_path (str): The path to the input video file.</span>
<span class="sd">        output_path (str): The path to the output video file.</span>
<span class="sd">        goal_size (list): The desired size [w,h] of the output video. Can be passed as built-in ffmpeg thing like [&#39;iw/2&#39;, -1] or as [int, int]</span>
<span class="sd">        to_resize_video (bool, optional): Whether or not to resize the input video to fit the output size.</span>
<span class="sd">        color (str, optional): The color of the space around the video. Can be passed as built-in ffmpeg color name (black, red etc.) or as hex string like &#39;FFFFFF&#39;.</span>
<span class="sd">        x_y_coordinate (list, optional): The x and y coordinates of the video within the output space. Can be passed as built-in ffmpeg thing like [&#39;iw/2&#39;, -1] or as [int, int]</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The path to the output video file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">codec_to_use</span> <span class="o">=</span> <span class="n">get_codec_meeting_constraints</span><span class="p">(</span><span class="n">goal_size</span><span class="p">)</span>
    <span class="n">scale_w</span> <span class="o">=</span> <span class="p">(</span><span class="n">goal_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">goal_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">goal_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">scale_h</span> <span class="o">=</span> <span class="p">(</span><span class="n">goal_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">goal_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">goal_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">resize_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;scale=</span><span class="si">{</span><span class="n">scale_w</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">scale_h</span><span class="si">}</span><span class="s1">,&#39;</span> <span class="k">if</span> <span class="n">to_resize_video</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
    <span class="n">filter_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;[0:v]</span><span class="si">{</span><span class="n">resize_str</span><span class="si">}</span><span class="s1">pad=width=</span><span class="si">{</span><span class="n">goal_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">:height=</span><span class="si">{</span><span class="n">goal_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">:x=</span><span class="si">{</span><span class="n">x_y_coordinate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">:y=</span><span class="si">{</span><span class="n">x_y_coordinate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">:color=</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s1">[v]&#39;</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;ffmpeg -y -i  &quot;</span><span class="si">{</span><span class="n">input_video_path</span><span class="si">}</span><span class="s1">&quot; -movflags +faststart &#39;</span> \
          <span class="sa">f</span><span class="s1">&#39;-filter_complex &quot;</span><span class="si">{</span><span class="n">filter_str</span><span class="si">}</span><span class="s1">&quot; -map &quot;[v]&quot; -map 0:a </span><span class="si">{</span><span class="n">C_CODEC_SETTINGS</span><span class="p">[</span><span class="n">codec_to_use</span><span class="p">]</span><span class="si">}</span><span class="s1"> &quot;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s1">&quot;&#39;</span>

    <span class="n">run_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">filter_str</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output_path</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="ffmpeg_python_utils.main.add_image_to_video" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_image_to_video</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">input_image_paths</span><span class="p">,</span> <span class="n">x_y_coordinates</span><span class="p">,</span> <span class="n">start_times</span><span class="p">,</span> <span class="n">durations</span><span class="p">,</span> <span class="n">img_goal_sizes</span><span class="p">,</span> <span class="n">opacities</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fade_duration</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Adds images to a video at specified times and positions.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_video_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path to the input video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path to the output video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>input_image_paths</code></td>
          <td>
                <code>list[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of paths to the input image files.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>x_y_coordinates</code></td>
          <td>
                <code>list[list]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of tuples specifying the x and y coordinates of each image.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>start_times</code></td>
          <td>
                <code>list[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of start times for each image in seconds.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>durations</code></td>
          <td>
                <code>list[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of durations for each image in seconds.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>img_goal_sizes</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of [w, h] specifying the width and height of each image after resizing. Can be passed as built-in ffmpeg thing like ['iw/2', -1]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>opacities</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of opacities for each image.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>fade_duration</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Duration of fade in and fade out for each image in seconds.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path to the output video file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>ffmpeg_python_utils\main.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@process</span>
<span class="k">def</span> <span class="nf">add_image_to_video</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">input_image_paths</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                       <span class="n">x_y_coordinates</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">],</span> <span class="n">start_times</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">durations</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
                       <span class="n">img_goal_sizes</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">opacities</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fade_duration</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds images to a video at specified times and positions.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_video_path (str): Path to the input video file.</span>
<span class="sd">        output_path (str): Path to the output video file.</span>
<span class="sd">        input_image_paths (list[str]): List of paths to the input image files.</span>
<span class="sd">        x_y_coordinates (list[list]): List of tuples specifying the x and y coordinates of each image.</span>
<span class="sd">        start_times (list[float]): List of start times for each image in seconds.</span>
<span class="sd">        durations (list[float]): List of durations for each image in seconds.</span>
<span class="sd">        img_goal_sizes (list): List of [w, h] specifying the width and height of each image after resizing. Can be passed as built-in ffmpeg thing like [&#39;iw/2&#39;, -1]</span>
<span class="sd">        opacities (list, optional): List of opacities for each image.</span>
<span class="sd">        fade_duration (float, optional): Duration of fade in and fade out for each image in seconds.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Path to the output video file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Make lists equal</span>
    <span class="n">input_image_paths</span><span class="p">,</span> <span class="n">x_y_coordinates</span><span class="p">,</span> <span class="n">start_times</span><span class="p">,</span> <span class="n">durations</span><span class="p">,</span> <span class="n">img_goal_sizes</span><span class="p">,</span> <span class="n">opacities</span> <span class="o">=</span> \
        <span class="n">make_lists_equal</span><span class="p">(</span><span class="n">input_image_paths</span><span class="o">=</span><span class="n">input_image_paths</span><span class="p">,</span> <span class="n">x_y_coordinates</span><span class="o">=</span><span class="n">x_y_coordinates</span><span class="p">,</span>
                         <span class="n">start_times</span><span class="o">=</span><span class="n">start_times</span><span class="p">,</span> <span class="n">durations</span><span class="o">=</span><span class="n">durations</span><span class="p">,</span>
                         <span class="n">img_goal_sizes</span><span class="o">=</span><span class="n">img_goal_sizes</span><span class="p">,</span> <span class="n">opacities</span><span class="o">=</span><span class="n">opacities</span><span class="p">)</span>

    <span class="c1"># Constructing input str and complex filter</span>
    <span class="n">files_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;-i &quot;</span><span class="si">{</span><span class="n">input_video_path</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
    <span class="n">filter_str_0</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">filter_str_1</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_image_paths</span><span class="p">)):</span>
        <span class="c1"># Resizing img</span>
        <span class="n">input_image_paths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_resized_image</span><span class="p">(</span><span class="n">input_image_paths</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="sa">f</span><span class="s1">&#39;temp_image__</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">,</span>
                                                 <span class="p">[</span><span class="n">img_goal_sizes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">img_goal_sizes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">files_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39; -loop 1 -i &quot;</span><span class="si">{</span><span class="n">input_image_paths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
        <span class="n">if_img_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">fade_duration</span> <span class="ow">or</span> <span class="p">(</span><span class="n">opacities</span> <span class="ow">and</span> <span class="n">opacities</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">and</span> <span class="n">opacities</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">filter_str_0</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;[</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">]&#39;</span>
            <span class="n">if_img_str</span> <span class="o">=</span> <span class="s1">&#39;img&#39;</span>
        <span class="k">if</span> <span class="n">fade_duration</span><span class="p">:</span>
            <span class="n">fade_duration</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">fade_duration</span><span class="p">,</span> <span class="n">durations</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">filter_str_0</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;fade=t=in:st=</span><span class="si">{</span><span class="n">start_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">:d=</span><span class="si">{</span><span class="n">fade_duration</span><span class="si">}</span><span class="s1">:alpha=1,&#39;</span> \
                            <span class="sa">f</span><span class="s1">&#39;fade=t=out:st=</span><span class="si">{</span><span class="n">start_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">durations</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">fade_duration</span><span class="si">}</span><span class="s1">:d=</span><span class="si">{</span><span class="n">fade_duration</span><span class="si">}</span><span class="s1">:alpha=1&#39;</span>
            <span class="n">filter_str_0</span> <span class="o">+=</span> <span class="s1">&#39;,&#39;</span> <span class="k">if</span> <span class="n">opacities</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">opacities</span> <span class="ow">and</span> <span class="n">opacities</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">and</span> <span class="n">opacities</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">filter_str_0</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;format=pix_fmts=rgba,colorchannelmixer=aa=</span><span class="si">{</span><span class="n">opacities</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">fade_duration</span> <span class="ow">or</span> <span class="p">(</span><span class="n">opacities</span> <span class="ow">and</span> <span class="n">opacities</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">and</span> <span class="n">opacities</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">filter_str_0</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;[img</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">];&#39;</span>

        <span class="n">filter_str_1</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;[0]&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;[bg</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">]&quot;</span>
        <span class="n">filter_str_1</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">if_img_str</span><span class="si">}{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">]overlay=x=</span><span class="si">{</span><span class="n">x_y_coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">:y=</span><span class="si">{</span><span class="n">x_y_coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">:&quot;</span> \
                        <span class="sa">f</span><span class="s2">&quot;enable=&#39;between(t,</span><span class="si">{</span><span class="n">start_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">start_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">durations</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">)&#39;:shortest=1[bg</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">];&quot;</span>

    <span class="c1"># Run command</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ffmpeg -y </span><span class="si">{</span><span class="n">files_str</span><span class="si">}</span><span class="s1"> &#39;</span>
           <span class="sa">f</span><span class="s1">&#39;-filter_complex &quot;</span><span class="si">{</span><span class="n">filter_str_0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">filter_str_1</span><span class="si">}</span><span class="s1">&quot; &#39;</span>
           <span class="sa">f</span><span class="s1">&#39;-map [bg</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">input_image_paths</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">]  -map 0 -map 0:a  -c:a copy </span><span class="si">{</span><span class="n">C_CODEC_SETTINGS</span><span class="p">[</span><span class="n">C_CODEC</span><span class="p">]</span><span class="si">}</span><span class="s1"> &#39;</span>
           <span class="sa">f</span><span class="s1">&#39;-movflags +faststart &quot;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s1">&quot; &#39;</span><span class="p">)</span>
    <span class="n">run_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">filter_str_0</span> <span class="o">+</span> <span class="n">filter_str_1</span><span class="p">)</span>

    <span class="c1"># Remove temporary image file</span>
    <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">()</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;temp_image&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">i</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.png&#39;</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">output_path</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="ffmpeg_python_utils.main.add_rectangle_to_video" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_rectangle_to_video</span><span class="p">(</span><span class="n">input_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">start_times</span><span class="p">,</span> <span class="n">durations</span><span class="p">,</span> <span class="n">x_y_coordinates</span><span class="p">,</span> <span class="n">sizes</span><span class="p">,</span> <span class="n">rect_colors</span><span class="p">,</span> <span class="n">opacities</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Adds a rectangle to a video using ffmpeg.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the input video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the output video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>start_times</code></td>
          <td>
                <code>list[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of start times in seconds for each rectangle.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>durations</code></td>
          <td>
                <code>list[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of durations for each rectangle.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>x_y_coordinates</code></td>
          <td>
                <code>list[list]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of [x,y] coordinates for each rectangle. Can be passed as built-in ffmpeg thing like 'iw/2'</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>sizes</code></td>
          <td>
                <code>list[list]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of sizes [w,h] for each rectangle. Can be passed as built-in ffmpeg thing like ['iw/2', -1]  or as [int, int]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rect_colors</code></td>
          <td>
                <code>list[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of colors for each rectangle. Can be passed as built-in ffmpeg color name (black, red etc.) or as hex string like 'FFFFFF'.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>opacities</code></td>
          <td>
                <code>list[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of opacities for each rectangle.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the output video file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>ffmpeg_python_utils\main.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@process</span>
<span class="k">def</span> <span class="nf">add_rectangle_to_video</span><span class="p">(</span><span class="n">input_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">start_times</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">durations</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
                           <span class="n">x_y_coordinates</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">],</span> <span class="n">sizes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">],</span> <span class="n">rect_colors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                           <span class="n">opacities</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds a rectangle to a video using ffmpeg.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_path (str): The path to the input video file.</span>
<span class="sd">        output_path (str): The path to the output video file.</span>
<span class="sd">        start_times (list[float]): A list of start times in seconds for each rectangle.</span>
<span class="sd">        durations (list[float]): A list of durations for each rectangle.</span>
<span class="sd">        x_y_coordinates (list[list]): A list of [x,y] coordinates for each rectangle. Can be passed as built-in ffmpeg thing like &#39;iw/2&#39;</span>
<span class="sd">        sizes (list[list]): A list of sizes [w,h] for each rectangle. Can be passed as built-in ffmpeg thing like [&#39;iw/2&#39;, -1]  or as [int, int]</span>
<span class="sd">        rect_colors (list[str]): A list of colors for each rectangle. Can be passed as built-in ffmpeg color name (black, red etc.) or as hex string like &#39;FFFFFF&#39;.</span>
<span class="sd">        opacities (list[float]): A list of opacities for each rectangle.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The path to the output video file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Make lists equal</span>
    <span class="n">start_times</span><span class="p">,</span> <span class="n">durations</span><span class="p">,</span> <span class="n">x_y_coordinates</span><span class="p">,</span> <span class="n">sizes</span><span class="p">,</span> <span class="n">rect_colors</span><span class="p">,</span> <span class="n">opacities</span> <span class="o">=</span> <span class="n">make_lists_equal</span><span class="p">(</span>
        <span class="n">start_times</span><span class="o">=</span><span class="n">start_times</span><span class="p">,</span> <span class="n">durations</span><span class="o">=</span><span class="n">durations</span><span class="p">,</span> <span class="n">x_y_coordinates</span><span class="o">=</span><span class="n">x_y_coordinates</span><span class="p">,</span> <span class="n">sizes</span><span class="o">=</span><span class="n">sizes</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">rect_colors</span><span class="p">,</span>
        <span class="n">opacities</span><span class="o">=</span><span class="n">opacities</span><span class="p">)</span>

    <span class="c1"># Constructing filter str</span>
    <span class="n">filter_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">start_times</span><span class="p">)):</span>
        <span class="n">filter_str</span> <span class="o">+=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;[box</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]&#39;</span>
        <span class="n">filter_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;drawbox=enable=</span><span class="se">\&#39;</span><span class="s1">between(t,</span><span class="si">{</span><span class="n">start_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">start_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">durations</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">)</span><span class="se">\&#39;</span><span class="s1">:x=</span><span class="si">{</span><span class="n">x_y_coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span> \
                      <span class="sa">f</span><span class="s1">&#39;:y=</span><span class="si">{</span><span class="n">x_y_coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">:w=</span><span class="si">{</span><span class="n">sizes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">:h=</span><span class="si">{</span><span class="n">sizes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">:color=</span><span class="si">{</span><span class="n">rect_colors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">@</span><span class="si">{</span><span class="n">opacities</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">:t=fill,&#39;</span> \
                      <span class="sa">f</span><span class="s1">&#39;format=yuva420p[box</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">];&#39;</span>
    <span class="c1"># Run</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;ffmpeg -y -i &quot;</span><span class="si">{</span><span class="n">input_path</span><span class="si">}</span><span class="s1">&quot; -movflags +faststart &#39;</span> \
          <span class="sa">f</span><span class="s1">&#39;-filter_complex &quot;</span><span class="si">{</span><span class="n">filter_str</span><span class="si">}</span><span class="s1">&quot; -map [box</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">start_times</span><span class="p">)</span><span class="si">}</span><span class="s1">] &#39;</span> \
          <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">C_CODEC_SETTINGS</span><span class="p">[</span><span class="n">C_CODEC</span><span class="p">]</span><span class="si">}</span><span class="s1"> &#39;</span> \
          <span class="sa">f</span><span class="s1">&#39;-c:a copy &quot;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
    <span class="n">run_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">filter_str</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output_path</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="ffmpeg_python_utils.main.add_text_to_video" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_text_to_video</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">texts</span><span class="p">,</span> <span class="n">fonts_paths</span><span class="p">,</span> <span class="n">font_sizes</span><span class="p">,</span> <span class="n">font_colors</span><span class="p">,</span> <span class="n">start_times</span><span class="p">,</span> <span class="n">durations</span><span class="p">,</span> <span class="n">x_y_coordinates</span><span class="p">,</span> <span class="n">fade_duration</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">border_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">border_width</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Adds text to a video and saves it.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_video_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path to the video to add texts to.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path to the new video.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>texts</code></td>
          <td>
                <code>list[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of texts to add.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fonts_paths</code></td>
          <td>
                <code>list[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of paths to fonts. At windows should be like "C\:\Windows\Fonts\Arial.ttf"</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>font_sizes</code></td>
          <td>
                <code>list[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of font sizes.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>font_colors</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of font colors. Can be passed as built-in ffmpeg color name (black, red etc.) or as hex string like 'FFFFFF'.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>start_times</code></td>
          <td>
                <code>list[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of start times in seconds.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>durations</code></td>
          <td>
                <code>list[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of durations in seconds.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>x_y_coordinates</code></td>
          <td>
                <code>list[list]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of [x, y] coordinates. Can be passed as built-in ffmpeg thing like '(w-text_w)/2'</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fade_duration</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Duration of the fade effect.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>border_color</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Color of the border. Can be passed as built-in ffmpeg color name (black, red etc.) or as hex string like 'FFFFFF'.</p>
            </div>
          </td>
          <td>
                <code>&#39;black&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>border_width</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Width of the border.</p>
            </div>
          </td>
          <td>
                <code>5</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path to the new video (output_path).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>ffmpeg_python_utils\main.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@process</span>
<span class="k">def</span> <span class="nf">add_text_to_video</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">texts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">fonts_paths</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                      <span class="n">font_sizes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">font_colors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">start_times</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">durations</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
                      <span class="n">x_y_coordinates</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">],</span> <span class="n">fade_duration</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">border_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                      <span class="n">border_width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds text to a video and saves it.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_video_path (str): Path to the video to add texts to.</span>
<span class="sd">        output_path (str): Path to the new video.</span>
<span class="sd">        texts (list[str]): List of texts to add.</span>
<span class="sd">        fonts_paths (list[str]): List of paths to fonts. At windows should be like &quot;C\:\\\\Windows\\\\Fonts\\\\Arial.ttf&quot;</span>
<span class="sd">        font_sizes (list[int]): List of font sizes.</span>
<span class="sd">        font_colors (list): List of font colors. Can be passed as built-in ffmpeg color name (black, red etc.) or as hex string like &#39;FFFFFF&#39;.</span>
<span class="sd">        start_times (list[float]): List of start times in seconds.</span>
<span class="sd">        durations (list[float]): List of durations in seconds.</span>
<span class="sd">        x_y_coordinates (list[list]): List of [x, y] coordinates. Can be passed as built-in ffmpeg thing like &#39;(w-text_w)/2&#39;</span>
<span class="sd">        fade_duration (float, optional): Duration of the fade effect.</span>
<span class="sd">        border_color (str, optional): Color of the border. Can be passed as built-in ffmpeg color name (black, red etc.) or as hex string like &#39;FFFFFF&#39;.</span>
<span class="sd">        border_width (int, optional): Width of the border.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Path to the new video (output_path).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Making dict lists equal</span>
    <span class="n">texts</span><span class="p">,</span> <span class="n">fonts_paths</span><span class="p">,</span> <span class="n">font_sizes</span><span class="p">,</span> <span class="n">font_colors</span><span class="p">,</span> <span class="n">x_y_coordinates</span><span class="p">,</span> <span class="n">durations</span><span class="p">,</span> <span class="n">start_times</span> <span class="o">=</span> \
        <span class="n">make_lists_equal</span><span class="p">(</span><span class="n">texts</span><span class="o">=</span><span class="n">texts</span><span class="p">,</span> <span class="n">fonts</span><span class="o">=</span><span class="n">fonts_paths</span><span class="p">,</span> <span class="n">font_sizes</span><span class="o">=</span><span class="n">font_sizes</span><span class="p">,</span>
                         <span class="n">font_colors</span><span class="o">=</span><span class="n">font_colors</span><span class="p">,</span> <span class="n">x_y_coordinates</span><span class="o">=</span><span class="n">x_y_coordinates</span><span class="p">,</span>
                         <span class="n">durations</span><span class="o">=</span><span class="n">durations</span><span class="p">,</span> <span class="n">start_times</span><span class="o">=</span><span class="n">start_times</span><span class="p">)</span>
    <span class="c1"># Setting files and filter strings</span>
    <span class="n">filter_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">texts</span><span class="p">)):</span>
        <span class="n">fade_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">fade_duration</span><span class="p">:</span>
            <span class="n">fade_duration_to_use</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">fade_duration</span><span class="p">,</span> <span class="n">durations</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">fade_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;:alpha=&#39;if(lt(t,</span><span class="si">{</span><span class="n">start_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">),0,if(lt(t,</span><span class="si">{</span><span class="n">start_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">fade_duration_to_use</span><span class="si">}</span><span class="s2">),(t-</span><span class="si">{</span><span class="n">start_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">)/</span><span class="si">{</span><span class="n">fade_duration_to_use</span><span class="si">}</span><span class="s2">,if(lt(t,</span><span class="si">{</span><span class="n">start_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">fade_duration_to_use</span><span class="si">}</span><span class="s2">),1,if(lt(t,</span><span class="si">{</span><span class="n">start_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">durations</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">),(</span><span class="si">{</span><span class="n">fade_duration_to_use</span><span class="si">}</span><span class="s2">-(t-</span><span class="si">{</span><span class="n">start_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">fade_duration_to_use</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">durations</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">))/</span><span class="si">{</span><span class="n">fade_duration_to_use</span><span class="si">}</span><span class="s2">,0))))&#39;&quot;</span>
        <span class="n">border_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">border_color</span><span class="p">:</span>
            <span class="n">border_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;:bordercolor=</span><span class="si">{</span><span class="n">border_color</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">border_width</span><span class="p">:</span>
            <span class="n">border_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;:borderw=</span><span class="si">{</span><span class="n">border_width</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">filter_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;[0:v]&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;[v</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]&#39;</span>
        <span class="n">filter_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;drawtext=fontfile=&#39;</span><span class="si">{</span><span class="n">fonts_paths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;:text=&#39;</span><span class="si">{</span><span class="n">texts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;:fontsize=</span><span class="si">{</span><span class="n">font_sizes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">:&quot;</span> \
                      <span class="sa">f</span><span class="s2">&quot;fontcolor=</span><span class="si">{</span><span class="n">font_colors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}{</span><span class="n">fade_str</span><span class="si">}</span><span class="s2">:x=</span><span class="si">{</span><span class="n">x_y_coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">:y=</span><span class="si">{</span><span class="n">x_y_coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">}{</span><span class="n">border_str</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">start_times</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">durations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">filter_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;:enable=&#39;between(t,</span><span class="si">{</span><span class="n">start_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">start_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">durations</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">)&#39;&quot;</span>
        <span class="n">filter_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;[v</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">]&#39;</span>
        <span class="n">filter_str</span> <span class="o">+=</span> <span class="s1">&#39;;&#39;</span>
    <span class="c1"># Run</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;ffmpeg -y -i &quot;</span><span class="si">{</span><span class="n">input_video_path</span><span class="si">}</span><span class="s1">&quot; -movflags +faststart &#39;</span> \
          <span class="sa">f</span><span class="s1">&#39;-filter_complex &quot;</span><span class="si">{</span><span class="n">filter_str</span><span class="si">}</span><span class="s1">&quot; -map [v</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span><span class="si">}</span><span class="s1">] -map 0:a </span><span class="si">{</span><span class="n">C_CODEC_SETTINGS</span><span class="p">[</span><span class="n">C_CODEC</span><span class="p">]</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">run_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">filter_str</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">output_path</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="ffmpeg_python_utils.main.add_video_to_video" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_video_to_video</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">video_to_overlay_paths</span><span class="p">,</span> <span class="n">goal_sizes</span><span class="p">,</span> <span class="n">x_y_coordinates</span><span class="p">,</span> <span class="n">start_times</span><span class="p">,</span> <span class="n">durations</span><span class="p">,</span> <span class="n">opacities</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fade_duration</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Adds a video overlay to a video using ffmpeg.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_video_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the input video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the output video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>video_to_overlay_paths</code></td>
          <td>
                <code>list[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of paths to the video files to overlay.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>goal_sizes</code></td>
          <td>
                <code>list[list]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of sizes [w,h] for each overlay video. Can be passed as built-in ffmpeg thing like ['iw/2', -1] or as [int, int]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>x_y_coordinates</code></td>
          <td>
                <code>list[list]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of [x,y] coordinates for each overlay video. Can be passed as built-in ffmpeg thing like ['iw/2', -1] or as [int, int]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>start_times</code></td>
          <td>
                <code>list[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of start times for each overlay video in seconds.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>durations</code></td>
          <td>
                <code>list[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of durations for each overlay video.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>opacities</code></td>
          <td>
                <code>list[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of opacities for each overlay video.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>fade_duration</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The duration of the fade in/out effect for each overlay video.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the output video file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>ffmpeg_python_utils\main.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@process</span>
<span class="k">def</span> <span class="nf">add_video_to_video</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">video_to_overlay_paths</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                       <span class="n">goal_sizes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">],</span> <span class="n">x_y_coordinates</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">],</span>
                       <span class="n">start_times</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">durations</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
                       <span class="n">opacities</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fade_duration</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds a video overlay to a video using ffmpeg.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_video_path (str): The path to the input video file.</span>
<span class="sd">        output_path (str): The path to the output video file.</span>
<span class="sd">        video_to_overlay_paths (list[str]): A list of paths to the video files to overlay.</span>
<span class="sd">        goal_sizes (list[list]): A list of sizes [w,h] for each overlay video. Can be passed as built-in ffmpeg thing like [&#39;iw/2&#39;, -1] or as [int, int]</span>
<span class="sd">        x_y_coordinates (list[list]): A list of [x,y] coordinates for each overlay video. Can be passed as built-in ffmpeg thing like [&#39;iw/2&#39;, -1] or as [int, int]</span>
<span class="sd">        start_times (list[float]): A list of start times for each overlay video in seconds.</span>
<span class="sd">        durations (list[float]): A list of durations for each overlay video.</span>
<span class="sd">        opacities (list[float], optional): A list of opacities for each overlay video.</span>
<span class="sd">        fade_duration (float, optional): The duration of the fade in/out effect for each overlay video.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The path to the output video file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Make lists equal</span>
    <span class="n">video_to_overlay_paths</span><span class="p">,</span> <span class="n">goal_sizes</span><span class="p">,</span> <span class="n">x_y_coordinates</span><span class="p">,</span> <span class="n">start_times</span><span class="p">,</span> <span class="n">durations</span><span class="p">,</span> <span class="n">opacities</span> <span class="o">=</span> <span class="n">make_lists_equal</span><span class="p">(</span>
        <span class="n">video_to_overlay_paths</span><span class="o">=</span><span class="n">video_to_overlay_paths</span><span class="p">,</span> <span class="n">goal_sizes</span><span class="o">=</span><span class="n">goal_sizes</span><span class="p">,</span> <span class="n">x_y_coordinates</span><span class="o">=</span><span class="n">x_y_coordinates</span><span class="p">,</span>
        <span class="n">start_times</span><span class="o">=</span><span class="n">start_times</span><span class="p">,</span> <span class="n">durations</span><span class="o">=</span><span class="n">durations</span><span class="p">,</span> <span class="n">opacities</span><span class="o">=</span><span class="n">opacities</span><span class="p">)</span>

    <span class="c1"># Get codec to use according to constraints</span>
    <span class="n">codec_to_use</span> <span class="o">=</span> <span class="n">get_codec_meeting_constraints</span><span class="p">(</span><span class="n">goal_sizes</span><span class="p">)</span>

    <span class="c1"># Construct input and filter strings</span>
    <span class="n">filter_str_0</span> <span class="o">=</span> <span class="s1">&#39;[0]format=pix_fmts=rgba[orig];&#39;</span>
    <span class="n">filter_str_1</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">input_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">video_to_overlay_paths</span><span class="p">)):</span>
        <span class="n">input_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;-i &quot;</span><span class="si">{</span><span class="n">video_to_overlay_paths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&quot; &#39;</span>

        <span class="n">filter_str_0</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;[</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">]&#39;</span>
        <span class="k">if</span> <span class="n">fade_duration</span><span class="p">:</span>
            <span class="n">fade_duration</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">fade_duration</span><span class="p">,</span> <span class="n">durations</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">filter_str_0</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;fade=t=in:st=</span><span class="si">{</span><span class="n">start_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">:d=</span><span class="si">{</span><span class="n">fade_duration</span><span class="si">}</span><span class="s1">:alpha=1,fade=t=out:st=</span><span class="si">{</span><span class="n">start_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">durations</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">fade_duration</span><span class="si">}</span><span class="s1">:d=</span><span class="si">{</span><span class="n">fade_duration</span><span class="si">}</span><span class="s1">:alpha=1,&#39;</span>
        <span class="k">if</span> <span class="n">fade_duration</span> <span class="ow">or</span> <span class="p">(</span><span class="n">opacities</span> <span class="ow">and</span> <span class="n">opacities</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">and</span> <span class="n">opacities</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">filter_str_0</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;format=pix_fmts=rgba,colorchannelmixer=aa=</span><span class="si">{</span><span class="n">opacities</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">,&#39;</span>
        <span class="n">filter_str_0</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;scale=</span><span class="si">{</span><span class="n">goal_sizes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">goal_sizes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">[v</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">];&#39;</span>

        <span class="n">filter_str_1</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;[orig]&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;[fin</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]&#39;</span>
        <span class="n">filter_str_1</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;[v</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">]overlay=</span><span class="si">{</span><span class="n">x_y_coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">x_y_coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">[fin</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">];&#39;</span>

    <span class="c1"># Run command</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;ffmpeg -y -i &quot;</span><span class="si">{</span><span class="n">input_video_path</span><span class="si">}</span><span class="s1">&quot; </span><span class="si">{</span><span class="n">input_str</span><span class="si">}</span><span class="s1"> -movflags +faststart -filter_complex &#39;</span> \
          <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">filter_str_0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">filter_str_1</span><span class="si">}</span><span class="s1">&quot;&#39;</span> \
          <span class="sa">f</span><span class="s1">&#39; -map [fin</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">video_to_overlay_paths</span><span class="p">)</span><span class="si">}</span><span class="s1">] -map 0:a &#39;</span> \
          <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">C_CODEC_SETTINGS</span><span class="p">[</span><span class="n">codec_to_use</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span> \
          <span class="sa">f</span><span class="s1">&#39; -c:a copy &quot;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
    <span class="n">run_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">filter_str_0</span> <span class="o">+</span> <span class="n">filter_str_1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">output_path</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="ffmpeg_python_utils.main.get_audio_from_video" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_audio_from_video</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">,</span> <span class="n">output_path</span><span class="o">=</span><span class="s1">&#39;audio.wav&#39;</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Extracts the audio from a video file using ffmpeg and saves it to a WAV file.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_video_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the input video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to save the output audio file.</p>
            </div>
          </td>
          <td>
                <code>&#39;audio.wav&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the output audio file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>ffmpeg_python_utils\main.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@process</span>
<span class="k">def</span> <span class="nf">get_audio_from_video</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;audio.wav&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts the audio from a video file using ffmpeg and saves it to a WAV file.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_video_path (str): The path to the input video file.</span>
<span class="sd">        output_path (str): The path to save the output audio file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The path to the output audio file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;ffmpeg -y -i &quot;</span><span class="si">{</span><span class="n">input_video_path</span><span class="si">}</span><span class="s1">&quot; -vn -acodec pcm_s16le -ar 44100 -ac 2 &quot;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
    <span class="n">run_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output_path</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="ffmpeg_python_utils.main.get_audio_info" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_audio_info</span><span class="p">(</span><span class="n">input_audio_file</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Get the duration, bitrate, and sample rate of an audio file using ffprobe.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_audio_file</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the input audio file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing the duration, bitrate, and sample rate of the audio.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>ffmpeg_python_utils\main.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@process</span>
<span class="k">def</span> <span class="nf">get_audio_info</span><span class="p">(</span><span class="n">input_audio_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the duration, bitrate, and sample rate of an audio file using ffprobe.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_audio_file (str): The path to the input audio file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing the duration, bitrate, and sample rate of the audio.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Run ffprobe command to get information about the input audio file</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;ffprobe -v error -print_format json -show_format -show_streams &quot;</span><span class="si">{</span><span class="n">input_audio_file</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
    <span class="n">ffprobe_output</span> <span class="o">=</span> <span class="n">run_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
    <span class="c1"># Parse the ffprobe output as JSON</span>
    <span class="n">ffprobe_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">ffprobe_output</span><span class="p">)</span>
    <span class="c1"># Get the audio stream information</span>
    <span class="n">audio_stream</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">stream</span> <span class="k">for</span> <span class="n">stream</span> <span class="ow">in</span> <span class="n">ffprobe_data</span><span class="p">[</span><span class="s1">&#39;streams&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">stream</span><span class="p">[</span><span class="s1">&#39;codec_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;audio&#39;</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
    <span class="c1"># Get the audio duration in seconds</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">audio_stream</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">])</span>
    <span class="c1"># Get the audio bitrate in kbps</span>
    <span class="n">bitrate</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">audio_stream</span><span class="p">[</span><span class="s1">&#39;bit_rate&#39;</span><span class="p">])</span> <span class="o">//</span> <span class="mi">1000</span>
    <span class="c1"># Get the audio sample rate in Hz</span>
    <span class="n">sample_rate</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">audio_stream</span><span class="p">[</span><span class="s1">&#39;sample_rate&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;duration&#39;</span><span class="p">:</span> <span class="n">duration</span><span class="p">,</span> <span class="s1">&#39;bitrate&#39;</span><span class="p">:</span> <span class="n">bitrate</span><span class="p">,</span> <span class="s1">&#39;sample_rate&#39;</span><span class="p">:</span> <span class="n">sample_rate</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="ffmpeg_python_utils.main.get_concantenated_videos" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_concantenated_videos</span><span class="p">(</span><span class="n">input_video_paths</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">effects</span><span class="p">,</span> <span class="n">transition_durations</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Concatenates multiple videos together using ffmpeg.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_video_paths</code></td>
          <td>
                <code>list[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of paths to the input video files.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the output video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>effects</code></td>
          <td>
                <code>list[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of transition effects to use between each video. See https://trac.ffmpeg.org/wiki/Xfade for options.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>transition_durations</code></td>
          <td>
                <code>list[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of durations for each transition.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the output video file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>ffmpeg_python_utils\main.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@process</span>
<span class="k">def</span> <span class="nf">get_concantenated_videos</span><span class="p">(</span><span class="n">input_video_paths</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">effects</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                             <span class="n">transition_durations</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Concatenates multiple videos together using ffmpeg.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_video_paths (list[str]): A list of paths to the input video files.</span>
<span class="sd">        output_path (str): The path to the output video file.</span>
<span class="sd">        effects (list[str]): A list of transition effects to use between each video. See https://trac.ffmpeg.org/wiki/Xfade for options.</span>
<span class="sd">        transition_durations (list[float]): A list of durations for each transition.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The path to the output video file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Make lists equal</span>
    <span class="n">input_video_paths</span><span class="p">,</span> <span class="n">effects</span><span class="p">,</span> <span class="n">transition_durations</span> <span class="o">=</span> <span class="n">make_lists_equal</span><span class="p">(</span>
        <span class="n">input_video_paths</span><span class="o">=</span><span class="n">input_video_paths</span><span class="p">,</span> <span class="n">effects</span><span class="o">=</span><span class="n">effects</span><span class="p">,</span> <span class="n">transition_durations</span><span class="o">=</span><span class="n">transition_durations</span><span class="p">)</span>

    <span class="c1"># Get input video durations</span>
    <span class="n">video_durations</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sizes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">input_video_path</span> <span class="ow">in</span> <span class="n">input_video_paths</span><span class="p">:</span>
        <span class="n">video_info</span> <span class="o">=</span> <span class="n">get_video_info</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">)</span>
        <span class="n">video_durations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">video_info</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">])</span>
        <span class="n">sizes</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">video_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">],</span> <span class="n">video_info</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]])</span>

    <span class="c1"># Checking for codec</span>
    <span class="n">codec_to_use</span> <span class="o">=</span> <span class="n">get_codec_meeting_constraints</span><span class="p">(</span><span class="n">sizes</span><span class="p">)</span>

    <span class="c1"># Calculate offset time</span>
    <span class="n">offsets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">video_durations</span><span class="p">)):</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">video_durations</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">transition_durations</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">offset</span> <span class="o">+=</span> <span class="n">offsets</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">offsets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>

    <span class="c1"># Construct input and filter str</span>
    <span class="n">input_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">filter_vid_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">filter_aud_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_video_paths</span><span class="p">)):</span>
        <span class="n">input_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;-i &quot;</span><span class="si">{</span><span class="n">input_video_paths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&quot; &#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_video_paths</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">filter_vid_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;[0]&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;[vv</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]&#39;</span>
        <span class="n">filter_aud_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;[0:a]&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;[afade</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]&#39;</span>
        <span class="n">filter_vid_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;[</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">:v]xfade=transition=</span><span class="si">{</span><span class="n">effects</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">:duration=1:offset=</span><span class="si">{</span><span class="n">offsets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">,format=yuv420p[vv</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">];&#39;</span>
        <span class="n">filter_aud_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;[</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">:a]acrossfade=d=</span><span class="si">{</span><span class="n">transition_durations</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">[afade</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">];&#39;</span>

    <span class="c1"># Run command</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;ffmpeg -y </span><span class="si">{</span><span class="n">input_str</span><span class="si">}</span><span class="s1">-movflags +faststart &#39;</span> \
          <span class="sa">f</span><span class="s1">&#39;-filter_complex &quot;</span><span class="si">{</span><span class="n">filter_vid_str</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">filter_aud_str</span><span class="si">}</span><span class="s1">&quot; &#39;</span> \
          <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">C_CODEC_SETTINGS</span><span class="p">[</span><span class="n">codec_to_use</span><span class="p">]</span><span class="si">}</span><span class="s1"> -map &quot;[vv</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">input_video_paths</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">]&quot; &#39;</span> \
          <span class="sa">f</span><span class="s1">&#39;-map &quot;[afade</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">input_video_paths</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">]&quot; -fps_mode vfr &quot;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
    <span class="n">run_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">filter_vid_str</span> <span class="o">+</span> <span class="n">filter_aud_str</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output_path</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="ffmpeg_python_utils.main.get_cropped_video" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_cropped_video</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">x_y_coordinate</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Crop a video file to a specified size and position.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_video_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the input video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to save the cropped video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>size</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A tuple containing the width and height of the cropped video. Can be passed as built-in ffmpeg thing like ['iw/2', -1] or as [int, int]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>x_y_coordinate</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A tuple containing the x and y coordinates of the top-left corner of the cropped video. Can be passed as built-in ffmpeg thing like ['iw/2', -1] or as [int, int]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the cropped video file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>ffmpeg_python_utils\main.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@process</span>
<span class="k">def</span> <span class="nf">get_cropped_video</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">x_y_coordinate</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Crop a video file to a specified size and position.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_video_path (str): The path to the input video file.</span>
<span class="sd">        output_path (str): The path to save the cropped video file.</span>
<span class="sd">        size (list): A tuple containing the width and height of the cropped video. Can be passed as built-in ffmpeg thing like [&#39;iw/2&#39;, -1] or as [int, int]</span>
<span class="sd">        x_y_coordinate (list): A tuple containing the x and y coordinates of the top-left corner of the cropped video. Can be passed as built-in ffmpeg thing like [&#39;iw/2&#39;, -1] or as [int, int]</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The path to the cropped video file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">codec_to_use</span> <span class="o">=</span> <span class="n">get_codec_meeting_constraints</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="n">filter_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;crop=</span><span class="si">{</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">x_y_coordinate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">x_y_coordinate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="c1"># Crop the video</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;ffmpeg -y -i &quot;</span><span class="si">{</span><span class="n">input_video_path</span><span class="si">}</span><span class="s1">&quot; -movflags use_metadata_tags -movflags +faststart -filter_complex &quot;</span><span class="si">{</span><span class="n">filter_str</span><span class="si">}</span><span class="s1">&quot; &#39;</span> \
          <span class="sa">f</span><span class="s1">&#39;-crf 17 -preset slow </span><span class="si">{</span><span class="n">C_CODEC_SETTINGS</span><span class="p">[</span><span class="n">codec_to_use</span><span class="p">]</span><span class="si">}</span><span class="s1"> -c:a copy &quot;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s1">&quot; &#39;</span>
    <span class="n">run_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">filter_str</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output_path</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="ffmpeg_python_utils.main.get_frame" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_frame</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Extract a single frame from a video file at a specified time.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_video_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the input video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to save the extracted frame.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>time</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The time at which to extract the frame in seconds.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the extracted frame.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>ffmpeg_python_utils\main.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@process</span>
<span class="k">def</span> <span class="nf">get_frame</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extract a single frame from a video file at a specified time.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_video_path (str): The path to the input video file.</span>
<span class="sd">        output_path (str): The path to save the extracted frame.</span>
<span class="sd">        time (float): The time at which to extract the frame in seconds.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The path to the extracted frame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;ffmpeg -y -i &quot;</span><span class="si">{</span><span class="n">input_video_path</span><span class="si">}</span><span class="s1">&quot; -ss </span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1"> -frames:v 1  -update 1 &quot;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
    <span class="n">run_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output_path</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="ffmpeg_python_utils.main.get_image_info" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_image_info</span><span class="p">(</span><span class="n">input_image_path</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Get the width and height of a video file using ffprobe.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_image_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the input video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing the width and height of the video.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>ffmpeg_python_utils\main.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@process</span>
<span class="k">def</span> <span class="nf">get_image_info</span><span class="p">(</span><span class="n">input_image_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the width and height of a video file using ffprobe.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_image_path (str): The path to the input video file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing the width and height of the video.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;ffprobe -v error -print_format json -show_format -show_streams </span><span class="si">{</span><span class="n">input_image_path</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">ffprobe_output</span> <span class="o">=</span> <span class="n">run_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
    <span class="n">ffprobe_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">ffprobe_output</span><span class="p">)</span>
    <span class="n">video_info</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">stream</span> <span class="k">for</span> <span class="n">stream</span> <span class="ow">in</span> <span class="n">ffprobe_data</span><span class="p">[</span><span class="s1">&#39;streams&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">stream</span><span class="p">[</span><span class="s1">&#39;codec_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;video&#39;</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">video_info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No video stream found in </span><span class="si">{</span><span class="n">input_image_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">video_info</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">])</span>
    <span class="n">height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">video_info</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="n">width</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">height</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="ffmpeg_python_utils.main.get_mirrored_video" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_mirrored_video</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Creates a horizontally mirrored version of a video file using ffmpeg and saves it to a new file.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_video_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the input video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to save the output mirrored video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the output mirrored video file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>ffmpeg_python_utils\main.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@process</span>
<span class="k">def</span> <span class="nf">get_mirrored_video</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a horizontally mirrored version of a video file using ffmpeg and saves it to a new file.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_video_path (str): The path to the input video file.</span>
<span class="sd">        output_path (str): The path to save the output mirrored video file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The path to the output mirrored video file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filter_str</span> <span class="o">=</span> <span class="s2">&quot;hflip&quot;</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;ffmpeg -y -i &quot;</span><span class="si">{</span><span class="n">input_video_path</span><span class="si">}</span><span class="s1">&quot; -movflags +faststart &#39;</span> \
          <span class="sa">f</span><span class="s1">&#39;-vf &quot;</span><span class="si">{</span><span class="n">filter_str</span><span class="si">}</span><span class="s1">&quot; </span><span class="si">{</span><span class="n">C_CODEC_SETTINGS</span><span class="p">[</span><span class="n">C_CODEC</span><span class="p">]</span><span class="si">}</span><span class="s1"> -c:a copy &quot;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
    <span class="n">run_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output_path</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="ffmpeg_python_utils.main.get_resized_image" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_resized_image</span><span class="p">(</span><span class="n">input_image_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Resize an image file to a specified size.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_image_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the input image file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to save the resized image file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>size</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A tuple containing the width and height of the resized image. Can be passed as built-in ffmpeg thing like ['iw/2', -1] or as [int, int]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the resized image file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>ffmpeg_python_utils\main.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@process</span>
<span class="k">def</span> <span class="nf">get_resized_image</span><span class="p">(</span><span class="n">input_image_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Resize an image file to a specified size.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_image_path (str): The path to the input image file.</span>
<span class="sd">        output_path (str): The path to save the resized image file.</span>
<span class="sd">        size (list): A tuple containing the width and height of the resized image. Can be passed as built-in ffmpeg thing like [&#39;iw/2&#39;, -1] or as [int, int]</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The path to the resized image file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filter_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;scale=</span><span class="si">{</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="c1"># Run command</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;ffmpeg -y -i &quot;</span><span class="si">{</span><span class="n">input_image_path</span><span class="si">}</span><span class="s1">&quot;  -filter_complex &quot;</span><span class="si">{</span><span class="n">filter_str</span><span class="si">}</span><span class="s1">&quot; -frames:v 1 -update 1 &quot;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
    <span class="n">run_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">filter_str</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output_path</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="ffmpeg_python_utils.main.get_resized_video" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_resized_video</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Resize a video file to a specified size.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_video_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the input video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to save the resized video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>size</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A tuple containing the width and height of the resized video. Can be passed as built-in ffmpeg thing like ['iw/2', -1] or as [int, int]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the resized video file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>ffmpeg_python_utils\main.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@process</span>
<span class="k">def</span> <span class="nf">get_resized_video</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Resize a video file to a specified size.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_video_path (str): The path to the input video file.</span>
<span class="sd">        output_path (str): The path to save the resized video file.</span>
<span class="sd">        size (list): A tuple containing the width and height of the resized video. Can be passed as built-in ffmpeg thing like [&#39;iw/2&#39;, -1] or as [int, int]</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The path to the resized video file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">codec_to_use</span> <span class="o">=</span> <span class="n">get_codec_meeting_constraints</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="n">filter_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;[0:v]scale=</span><span class="si">{</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">[fin]&quot;</span>
    <span class="c1"># Run command</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;ffmpeg -y -i &quot;</span><span class="si">{</span><span class="n">input_video_path</span><span class="si">}</span><span class="s1">&quot;  -movflags +faststart &#39;</span> \
          <span class="sa">f</span><span class="s1">&#39;-filter_complex &quot;</span><span class="si">{</span><span class="n">filter_str</span><span class="si">}</span><span class="s1">&quot; -map [fin] -map 0:a -c:a copy </span><span class="si">{</span><span class="n">C_CODEC_SETTINGS</span><span class="p">[</span><span class="n">codec_to_use</span><span class="p">]</span><span class="si">}</span><span class="s1"> &quot;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
    <span class="n">run_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">filter_str</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output_path</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="ffmpeg_python_utils.main.get_rotated_video" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_rotated_video</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">degree</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Rotates a video file clockwise by a specified degree using ffmpeg and saves it to a new file.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_video_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the input video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to save the output rotated video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>degree</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The degree to rotate the video clockwise.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the output rotated video file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>ffmpeg_python_utils\main.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@process</span>
<span class="k">def</span> <span class="nf">get_rotated_video</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">degree</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rotates a video file clockwise by a specified degree using ffmpeg and saves it to a new file.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_video_path (str): The path to the input video file.</span>
<span class="sd">        output_path (str): The path to save the output rotated video file.</span>
<span class="sd">        degree (float): The degree to rotate the video clockwise.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The path to the output rotated video file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;ffmpeg -y -i &quot;</span><span class="si">{</span><span class="n">input_video_path</span><span class="si">}</span><span class="s1">&quot; -movflags +faststart &#39;</span> \
          <span class="sa">f</span><span class="s1">&#39;-vf &quot;rotate=</span><span class="si">{</span><span class="n">degree</span><span class="si">}</span><span class="s1">*(PI/180)&quot; </span><span class="si">{</span><span class="n">C_CODEC_SETTINGS</span><span class="p">[</span><span class="n">C_CODEC</span><span class="p">]</span><span class="si">}</span><span class="s1"> &quot;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
    <span class="n">run_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output_path</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="ffmpeg_python_utils.main.get_subclips_with_sound" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_subclips_with_sound</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">subclip_times</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Extract subclips from a video file and concatenate them into a single video file with sound.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_video_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the input video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to save the concatenated video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>subclip_times</code></td>
          <td>
                <code>list[list[float]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of lists containing the start and end times in seconds of each subclip in the format [[start1, end1], [start2, end2], ...].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the concatenated video file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>ffmpeg_python_utils\main.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@process</span>
<span class="k">def</span> <span class="nf">get_subclips_with_sound</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subclip_times</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extract subclips from a video file and concatenate them into a single video file with sound.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_video_path (str): The path to the input video file.</span>
<span class="sd">        output_path (str): The path to save the concatenated video file.</span>
<span class="sd">        subclip_times (list[list[float]]): A list of lists containing the start and end times in seconds of each subclip in the format [[start1, end1], [start2, end2], ...].</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The path to the concatenated video file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Construct filter and input str</span>
    <span class="n">input_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">filter_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">subclip_times</span><span class="p">):</span>
        <span class="n">input_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;-ss </span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s1"> -to </span><span class="si">{</span><span class="n">end</span><span class="si">}</span><span class="s1"> -i &quot;</span><span class="si">{</span><span class="n">input_video_path</span><span class="si">}</span><span class="s1">&quot; &#39;</span>
        <span class="n">filter_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">:v][</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">:a]&#39;</span>
    <span class="n">filter_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;concat=a=1:n=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">subclip_times</span><span class="p">)</span><span class="si">}</span><span class="s1">:v=1[s0]&#39;</span>
    <span class="c1"># Run command</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;ffmpeg -y </span><span class="si">{</span><span class="n">input_str</span><span class="si">}</span><span class="s1"> -movflags +faststart &#39;</span> \
          <span class="sa">f</span><span class="s1">&#39;-filter_complex &quot;</span><span class="si">{</span><span class="n">filter_str</span><span class="si">}</span><span class="s1">&quot; -map [s0] </span><span class="si">{</span><span class="n">C_CODEC_SETTINGS</span><span class="p">[</span><span class="n">C_CODEC</span><span class="p">]</span><span class="si">}</span><span class="s1"> &quot;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
    <span class="n">run_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">filter_str</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output_path</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="ffmpeg_python_utils.main.get_video_from_picture" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_video_from_picture</span><span class="p">(</span><span class="n">input_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Creates a video file from a single image file using ffmpeg and saves it to a new file.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the input image file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to save the output video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>duration</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The duration of the output video file in seconds.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the output video file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>ffmpeg_python_utils\main.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@process</span>
<span class="k">def</span> <span class="nf">get_video_from_picture</span><span class="p">(</span><span class="n">input_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">duration</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a video file from a single image file using ffmpeg and saves it to a new file.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_path (str): The path to the input image file.</span>
<span class="sd">        output_path (str): The path to save the output video file.</span>
<span class="sd">        duration (float): The duration of the output video file in seconds.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The path to the output video file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;ffmpeg -y -loop 1 -i </span><span class="si">{</span><span class="n">input_path</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">C_CODEC_SETTINGS</span><span class="p">[</span><span class="n">C_CODEC</span><span class="p">]</span><span class="si">}</span><span class="s1"> -t </span><span class="si">{</span><span class="n">duration</span><span class="si">}</span><span class="s1"> &#39;</span> \
          <span class="sa">f</span><span class="s1">&#39;-movflags +faststart -pix_fmt yuv420p </span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">run_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output_path</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="ffmpeg_python_utils.main.get_video_info" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_video_info</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Get the duration, width, height, and FPS of a video file using ffprobe.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_video_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the input video file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing the duration, width, height, and FPS of the video.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>ffmpeg_python_utils\main.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@process</span>
<span class="k">def</span> <span class="nf">get_video_info</span><span class="p">(</span><span class="n">input_video_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the duration, width, height, and FPS of a video file using ffprobe.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_video_path (str): The path to the input video file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing the duration, width, height, and FPS of the video.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get the metadata of the video</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;ffprobe -v error -print_format json -show_format -show_streams &quot;</span><span class="si">{</span><span class="n">input_video_path</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">run_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="c1"># Get the duration of the video</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;format&#39;</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">])</span>
    <span class="c1"># Get the size and FPS of the video</span>
    <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">fps</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">stream</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;streams&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">stream</span><span class="p">[</span><span class="s1">&#39;codec_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;video&#39;</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span>
            <span class="n">fps</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="s1">&#39;r_frame_rate&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;duration&#39;</span><span class="p">:</span> <span class="n">duration</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="n">width</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">height</span><span class="p">,</span> <span class="s1">&#39;fps&#39;</span><span class="p">:</span> <span class="n">fps</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.b425cdc4.min.js"></script>
      
    
  </body>
</html>